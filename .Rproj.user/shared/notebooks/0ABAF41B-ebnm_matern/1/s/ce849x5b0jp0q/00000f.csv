"0","library(gridExtra)"
"2","
Attaching package: ‘gridExtra’

"
"2","The following object is masked from ‘package:dplyr’:

    combine

"
"0","grid_res <- 200"
"0","fine_locations <- expand.grid("
"0","  x = seq(0, 1, length.out = grid_res),"
"0","  y = seq(0, 1, length.out = grid_res)"
"0",")"
"0",""
"0","# Evaluate f1 and f2 on the grid"
"0","fine_locations$f1 <- f(fine_locations[,1], fine_locations[,2], center_x = 0.5, center_y = 0.4, scale = 0.2)"
"0","fine_locations$f2 <- f(fine_locations[,1], fine_locations[,2], center_x = 0.2, center_y = 0.7, scale = 0.2)"
"0","fine_locations$f1 <- fine_locations$f1 /max(fine_locations$f1)"
"0","fine_locations$f2 <- fine_locations$f2 /max(fine_locations$f2)"
"0",""
"0","# Create the heatplots"
"0","plot_f1 <- ggplot(fine_locations, aes(x = x, y = y, fill = f1)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradientn(colors = terrain.colors(10)) +"
"0","  labs(title = ""Heatmap of f1"", x = ""X Coordinate"", y = ""Y Coordinate"", fill = ""f1"") + "
"0","  # remove the legend"
"0","  theme(legend.position = ""none"") +"
"0","  theme_classic()"
"0",""
"0","plot_f2 <- ggplot(fine_locations, aes(x = x, y = y, fill = f2)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradientn(colors = terrain.colors(10)) +"
"0","  labs(title = ""Heatmap of f2"", x = ""X Coordinate"", y = ""Y Coordinate"", fill = ""f2"") +"
"0","  theme_classic()"
"0",""
"0","library(akima)"
"0",""
"0","locations$fitted_f1 <- F_gp_norm1"
"0","locations$fitted_f2 <- F_gp_norm2"
"0",""
"0","interp_f1 <- with(locations, interp(x, y, fitted_f1, duplicate = ""mean""))"
"2","Warning: collinear points, trying to add some jitter to avoid colinearities!"
"2","Warning: success: collinearities reduced through jitter"
"0","interp_f2 <- with(locations, interp(x, y, fitted_f2, duplicate = ""mean""))"
"2","Warning: collinear points, trying to add some jitter to avoid colinearities!"
"2","Warning: success: collinearities reduced through jitter"
"0","interp_f1_df <- data.frame("
"0","  x = rep(interp_f1$x, times = length(interp_f1$y)),"
"0","  y = rep(interp_f1$y, each = length(interp_f1$x)),"
"0","  fitted_f1 = as.vector(interp_f1$z)"
"0",")"
"0","interp_f2_df <- data.frame("
"0","  x = rep(interp_f2$x, times = length(interp_f2$y)),"
"0","  y = rep(interp_f2$y, each = length(interp_f2$x)),"
"0","  fitted_f2 = as.vector(interp_f2$z)"
"0",")"
"0",""
"0","interp_f1_df$fitted_f1 <- interp_f1_df$fitted_f1 / max(na.omit(interp_f1_df$fitted_f1))"
"0","interp_f2_df$fitted_f2 <- interp_f2_df$fitted_f2 / max(na.omit(interp_f2_df$fitted_f2))"
"0",""
"0","plot_f1_fitted <- ggplot(interp_f1_df, aes(x = x, y = y, fill = fitted_f1)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradientn(colors = terrain.colors(10)) +"
"0","  labs(title = ""Heatmap of fitted_f1"", x = ""X Coordinate"", y = ""Y Coordinate"", fill = ""f1"") +"
"0","  theme_classic()"
"0",""
"0","plot_f2_fitted <- ggplot(interp_f2_df, aes(x = x, y = y, fill = fitted_f2)) +"
"0","  geom_tile() +"
"0","  scale_fill_gradientn(colors = terrain.colors(10)) +"
"0","  labs(title = ""Heatmap of fitted_f2"", x = ""X Coordinate"", y = ""Y Coordinate"", fill = ""f2"") +"
"0","  theme_classic()"
"0",""
"0","# Display the plots in 2x2 grid"
"0","grid.arrange(plot_f1, plot_f2, plot_f1_fitted, plot_f2_fitted, ncol = 2)"
