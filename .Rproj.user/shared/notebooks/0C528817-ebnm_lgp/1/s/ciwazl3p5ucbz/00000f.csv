"0","n <- 1000"
"0","P <- 50"
"0","K <- 2"
"0","sigma_E <- 1"
"0","set.seed(123)"
"0","f1 <- rexp(P) * rbinom(P, 1, 0.3); f2 <- rexp(P) * rbinom(P, 1, 0.7)"
"0","F_mat <- matrix(c(f1,f2), byrow = F, nrow = P, ncol = K)"
"0",""
"0","t_vec <- seq(0, 2*pi, length.out = n)"
"0","l1 <- sin(t_vec); l2 <- cos(t_vec)"
"0",""
"0","l1_norm <- l1/sqrt(sum(l1^2)); l2_norm <- l2/sqrt(sum(l2^2))"
"0","f1_norm <- f1*sqrt(sum(l1^2)); f2_norm <- f2*sqrt(sum(l2^2))"
"0",""
"0","L_mat <- matrix(c(l1,l2), byrow = F, nrow = n, ncol = K)"
"0","E_mat <- matrix(rnorm(n*P, sd = sigma_E), nrow = n, ncol = P)"
"0","Y <- L_mat %*% t(F_mat) + E_mat"
